# family_num_spiral　📘 スパイラル回覧PDF作成ツール（家庭番号自動配置）

このツールは、父母会・保護者会等で配布される「回覧」冊子の表紙として使える**スパイラル配置PDF**を自動生成するGoogle Colabノートブックです。

---

## 🧩 機能一覧

- ✔️ **家庭番号をスパイラル状に自動配置**
- ✔️ **100〜500番台ごとにページを分割**
- ✔️ **各ページに日本語タイトル・説明文を中央配置**
- ✔️ **家庭番号は円で囲み、ゼロ埋めで表示（例: 101 → 101）**
- ✔️ **PDFは `/tmp/` に生成され、完了後に自動ダウンロード**
- ✔️ **スパイラル間隔やフォントサイズをGUIで調整可能**

---

## 📥 使用手順

### セルを実行すると、必要なライブラリとフォントが自動インストールされます

GUIが表示されるまで少し時間がかかります。

### 各種パラメータをGUIで入力

- **中央タイトル**：スパイラルの中心に表示されるタイトル（例：「回覧」）
- **説明文サイズ**：上下の補足文のフォントサイズ
- **円の大きさ**：番号を囲む円の直径
- **スパイラル間隔**：渦巻きの巻きの強さ
- **出力ファイル名**：生成されるPDFファイル名（例：`spiral_kairan.pdf`）

### Excelアップロード」で `.xlsx` ファイルを選択

- **1列目に家庭番号を記載したExcelファイル**をご用意ください。
- 見出し行は不要です。全行が番号として扱われます。

### 「PDF作成 ▶」ボタンをクリック

- 番台（100〜500番台）ごとにページを分けてPDFを生成します。
- 完了後、自動でファイルをダウンロードします。

---

## 📂 入力Excelファイルの例

https://github.com/taka-too/family_num_spiral/raw/refs/heads/main/family_number.xlsx

---

## 📤 出力PDFの特徴

出力ファイルの例
https://github.com/taka-too/family_num_spiral/raw/refs/heads/main/spiral_kairan-2.pdf

- ページごとに：
  - スパイラル配置された家庭番号（同じ番台内）
  - 中央に「回覧」などのタイトル
  - 上下に説明文

- フォント：Google Colabに内蔵されている Noto Sans CJK JP
- PDF内に**フォントも埋め込み済み**なので文字化けの心配なし


---

## ✅ 注意点

- Excelは `.xlsx` 形式のみ対応
- 家庭番号はすべて整数で記載してください
- 番台に該当する番号がないページは出力されません
- PDFは `/tmp/` に一時保存されるため、**セッションが終了すると破棄されます**
